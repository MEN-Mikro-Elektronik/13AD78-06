<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<title>MEN - AD78/PUx MDIS Driver - AD78_WIN Windows service</title>
<meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<meta name="Language" content="en, english">
<meta name="Copyright" content="All material copyright MEN Mikro Elektronik GmbH">
<link href="men_stylesheet.css" rel="stylesheet" type="text/css">
</head>
<body>

<div class="left_to_right" style="padding-top: 6px; background-color: #F0F0F0; height: 110px; border-bottom: 2px solid #D1D1D2;">
	<!-- Titel -->
	<img src="menlogo.gif" alt="MEN" style="float: left; height: 103px; width: 155px; margin: 0px;"></a>
	<h1 style="margin: 0px; padding-top: 35px; padding-bottom: 0px;">AD78/PUx MDIS Driver &nbsp; </h1>
	<h3>AD78_WIN Windows service</h3>
</div>

<div class="left_to_right">
<!-- Hauptteil -->
	<div class="main">
<!-- Generated by Doxygen 1.3.2 -->
<div class="qindex"><a class="qindex" href="index.html">Main&nbsp;Page</a> | <a class="qindex" href="modules.html">Modules</a> | <a class="qindex" href="annotated.html">Data&nbsp;Structures</a> | <a class="qindex" href="files.html">File&nbsp;List</a> | <a class="qindex" href="functions.html">Data&nbsp;Fields</a> | <a class="qindex" href="globals.html">Globals</a> | <a class="qindex" href="pages.html">Related&nbsp;Pages</a> | <a class="qindex" href="examples.html">Examples</a></div>
<h1><a name="_AD78_WIN">AD78_WIN Windows service</a>
</h1>The AD78_WIN Windows service is an example that demonstrates the usage of the AD78 driver from a Windows service.<p>
<br>
 <h2><a name="_AD78_WIN_FuncDesc"></a>
Functional Description</h2>
The AD78_WIN Windows service performs the following tasks:<ul>
<li><a class="el" href="ad78__win_8c.html#a10">ServiceJob()</a>: sends an ON Acknowledge (<a class="el" href="ad78__drv_8h.html#a1">AD78_ONACK</a>) when the service starts</li><li>configures the AD78 PSU:<ul>
<li>no shutdown delay (<a class="el" href="ad78__drv_8h.html#a7">AD78_DOWN_DELAY</a>)</li><li>1min OFF delay (<a class="el" href="ad78__drv_8h.html#a8">AD78_OFF_DELAY</a>)</li></ul>
</li><li>polls every second the shutdown event flag (<a class="el" href="ad78__drv_8h.html#a9">AD78_DOWN_EVT</a>), and if the flag is set:<ul>
<li>forces a Windows shutdown</li></ul>
</li><li>sends an SW power off (<a class="el" href="ad78__drv_8h.html#a5">AD78_SWOFF</a>) to the PSU if a Windows shutdown is in progress<br>
</li></ul>
<p>
<b>Please, refer to the example section to view implementation details in the source code.</b><p>
<br>
 <h2><a name="_AD78_WIN_Usage"></a>
AD78_WIN Usage</h2>
The AD78_WIN service must be copied to the target system and then be registered with the Service Control utility (SC.exe) that is included in Windows XP and the Microsoft Platform SDK: <div class="fragment"><pre>    C:\&gt;sc create ad78_win binPath= C:\SERVICES\ad78_win.exe start= <span class="keyword">auto</span>
</pre></div><br>
<p>
After this, the service will be automatically started during the Windows boot. However, the service can be manually started/stopped with the Windows services control panel utility or the SC.exe tool: <div class="fragment"><pre>    C:\&gt;sc start ad78_win
</pre></div>
	</div>
</div>

<div class="footer">
<!-- Footer -->
	<p class="footer">
	Generated for AD78/PUx MDIS Driver using <a href="http://www.doxygen.org">doxygen</a>.<br>
	Copyright &copy; 2010 <a href="http://www.men.de">MEN Mikro Elektronik GmbH</a>. All Rights Reserved.
	</p>
</div>

</body>
</html>

